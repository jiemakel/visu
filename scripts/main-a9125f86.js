(function(){function t(t,n){for(var e=-1,o=n.length>>>0;++e<o;)if(t===n[e])return!0;return!1}YASR.plugins.gmaps=function(n){var e;return e=n.container.closest("[id]").attr("id"),{yasr:n,name:"Google Maps",hideFromSelection:!1,priority:1,canHandleResults:function(n){return n.results&&n.results.getVariables&&n.results.getVariables()&&t("lat",n.results.getVariables())&&t("lon",n.results.getVariables())},draw:function(){var t,e,o,r,a,i,l,s;for(n.resultsContainer.html('<div id="gmap"></div>'),t={mapTypeId:google.maps.MapTypeId.SATELLITE},e=new google.maps.Map(n.resultsContainer.find("div")[0],t),o=new google.maps.LatLngBounds,r=0,i=(a=n.results.getBindings()).length;i>r;++r)l=a[r],s=new google.maps.LatLng(l.lat.value,l.lon.value),o.extend(s),new google.maps.Marker({position:s,map:e,title:null!=l.name?l.name.value:l.lat.value+","+l.lon.value});e.fitBounds(o),e.panToBounds(o)}}}}).call(this),function(){YASR.plugins.kml=function(t){var n;return n=t.container.closest("[id]").attr("id"),{yasr:t,name:"KML",hideFromSelection:!1,priority:1,canHandleResults:function(){return!0},draw:function(){var n,e,o;n=t.yasqe.getOption("sparql").endpoint,e=t.yasqe.getValue(),o="http://demo.seco.tkk.fi/sparql2kml/?endpoint="+encodeURIComponent(n)+"&query="+encodeURIComponent(e),t.resultsContainer.html('<button id="kml-copy" class="yasr_btn" style="float:right;position:relative; top:-30px;margin-bottom:-30px">Copy</button><div>URL for KML file: <a href="" id="kml-url"></a> (<a id="kml-e4d" href="" target="_blank">in Europeana 4D</a>)</div>'),$("#kml-url").text(o).attr("href",o),$("#kml-e4d").attr("href","http://www.informatik.uni-leipzig.de:8080/e4D/?source1=1&kml1="+encodeURIComponent(o)),$("#kml-copy").click(function(){window.prompt("Copy to clipboard with Ctrl/Cmd-C",o)}),$.ajax("https://www.googleapis.com/urlshortener/v1/url",{data:JSON.stringify({key:"AIzaSyDtS96pmj2IeRdw81zobVDpCfs0rFphHvc",longUrl:o}),contentType:"application/json",type:"POST"}).success(function(t){o=t.id,$("#kml-url").text(o).attr("href",o),$("#kml-e4d").attr("href","http://www.informatik.uni-leipzig.de:8080/e4D/?source1=1&kml1="+encodeURIComponent(o))})}}}}.call(this),function(){"use strict";angular.module("app",["ui.router","ngStorage"]).config(["$stateProvider","$urlRouterProvider",function(t,n){return t.state("home",{url:"/?sparqlEndpoint&query&outputType&chartConfig&motionChartState",templateUrl:"partials/main.html",controller:"MainCtrl"}),n.otherwise("/")}])}.call(this),function(){"use strict";angular.module("app").controller("MainCtrl",["$window","$location","$http","$scope","$localStorage","$state","$stateParams",function(t,n,e,o,r,a,i){var l,s,p;return null!=i.sparqlEndpoint&&(r.sparqlEndpoint=i.sparqlEndpoint),null!=r.sparqlEndpoint&&(o.sparqlEndpoint=r.sparqlEndpoint),o.shareLink=function(){var r;r=n.absUrl().substring(0,n.absUrl().indexOf("#"))+a.href(".",{sparqlEndpoint:o.sparqlEndpoint,query:l.getValue(),outputType:s.options.output,chartConfig:s.options.gchart.chartConfig,motionChartState:s.options.gchart.motionChartState}),o.shareLinkLoading=!0,e.post("https://www.googleapis.com/urlshortener/v1/url",{key:"AIzaSyDtS96pmj2IeRdw81zobVDpCfs0rFphHvc",longUrl:r}).then(function(n){o.shareLinkLoading=!1,t.prompt("Copy to clipboard with Ctrl/Cmd-C",n.data.id)},function(){o.shareLinkLoading=!1,t.prompt("Copy to clipboard with Ctrl/Cmd-C",r)})},l=YASQE(document.getElementById("yasqe"),{createShareLink:!1,sparql:{showQueryButton:!0,endpoint:o.sparqlEndpoint,query:""}}),null!=i.query&&l.setValue(i.query),o.sparqlEndpointInputValid=!0,o.$watch("sparqlEndpoint",function(t,n){null!=t&&e({method:"GET",url:t,params:{query:"ASK {}"},headers:{Accept:"application/sparql-results+json"}}).success(function(t){o.sparqlEndpointInputValid=null!=t["boolean"]}).error(function(){o.sparqlEndpointInputValid=!1}),t!==n&&(r.sparqlEndpoint=t,l.getOption("sparql").endpoint=t)}),s=YASR(document.getElementById("yasr"),{persistency:{outputSelector:i.outputType?!1:"visu",results:!1},getUsedPrefixes:l.getPrefixesFromQuery,output:null!=(p=i.outputType)?p:void 0,gchart:{chartConfig:i.chartConfig,motionChartState:i.motionChartState}}),s.yasqe=l,s.options.persistency.outputSelector="visu",l.options.sparql.handlers.success=function(t,n,e){return s.setResponse({response:t,contentType:e.getResponseHeader("Content-Type")})},l.options.sparql.handlers.error=function(t,n,e){var o;return o=n+" (response status code "+t.status+")",e&&e.length&&(o+=": "+e),s.setResponse({exception:o})},null!=i.sparqlEndpoint&&null!=i.query?l.query():void 0}])}.call(this),function(t){try{t=angular.module("app")}catch(n){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("partials/main.html",'\n<div class="ui page grid">\n  <div class="column">\n    <h1 class="ui header center aligned">(Visual) SPARQL query tool</h1>\n    <div id="shareicondiv"><i id="shareicon" ng-click="shareLink()" ng-class="shareLinkLoading ? \'loading\' : \'share\'" class="icon"></i></div>\n    <div class="ui form">\n      <div ng-class="{ \'error\': !sparqlEndpointInputValid }" class="field">\n        <label>SPARQL endpoint</label>\n        <input ng-model="sparqlEndpoint" type="text"/>\n      </div>\n      <div id="yasqe"></div>\n    </div>\n    <div id="yasr"></div>\n  </div>\n</div>')}])}();